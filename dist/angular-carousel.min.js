/**
 * Angular Carousel - Mobile friendly touch carousel for AngularJS
 * @version v0.0.9 - 2014-01-05
 * @link http://revolunet.github.com/angular-carousel
 * @author Julien Bouquillon <julien@revolunet.com>
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
angular.module("angular-carousel",["ngTouch"]),angular.module("angular-carousel").directive("rnCarouselIndicators",[function(){return{restrict:"A",replace:!0,scope:{items:"=",index:"="},template:'<div class="rn-carousel-indicator"><span ng-repeat="item in items" ng-class="{active: $index==$parent.index}">‚óè</span></div>'}}]),function(){"use strict";angular.module("angular-carousel").directive("rnCarousel",["$swipe","$window","$document","$parse",function(a,b,c,d){var e=0,f=75,g=.05,h=3;return{restrict:"A",scope:!0,compile:function(i,j){var k,l,m=i.children()[0].attributes,n=!1,o=!1,p=0,q=!1;if(i.addClass("rn-carousel-slides"),i.children().addClass("rn-carousel-slide"),["ng-repeat","data-ng-repeat","x-ng-repeat"].every(function(a){var b=m[a];if(angular.isDefined(b)){var c=b.value.match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?\s*$/),d=c[3];if(k=c[1],l=c[2],k)return angular.isDefined(j.rnCarouselBuffered)&&(o=!0,b.value=k+" in "+l+"|carouselSlice:carouselBufferIndex:carouselBufferSize",d&&(b.value+=" track by "+d)),n=!0,!1}return!0}),!n){{i.children()}p=i.children().length}return function(i,j,k){function m(){var a=M.children();return E=0===a.length?M[0].getBoundingClientRect().width:a[0].getBoundingClientRect().width}function r(){N.css("width",m()+"px")}function s(a){isNaN(a)&&(a=i.carouselIndex*E),L=a;var b=-Math.round(L);b+=i.carouselBufferIndex*E,M[0].style[F]="translate3d("+b+"px, 0, 0)"}function t(){var a,b;I&&(a=Date.now()-K,b=I*Math.exp(-a/f),b>h||-h>b?(s(J-b),requestAnimationFrame(t)):w(J/E))}function u(a){return a>=p?p:0>=a?0:a}function v(){var a=0,b=(i.carouselBufferSize-1)/2;o&&(a=i.carouselIndex<=b?0:i.carouselIndex>p-i.carouselBufferSize?p-i.carouselBufferSize:i.carouselIndex-b),i.carouselBufferIndex=a}function w(a,b){return isNaN(a)&&(a=i.carouselIndex),b?(L=a*E,C(null,null,!0),void 0):(i.carouselIndex=u(a),v(),"$apply"!==i.$$phase&&"$digest"!==i.$$phase&&(q?i.$apply():i.$digest()),s(),void 0)}function x(){return g*E}function y(a){C({x:a.clientX,y:a.clientY},a)}function z(a){var b=a;return 0===i.carouselIndex?b=Math.max(-x(),b):i.carouselIndex===p-1&&(b=Math.min((p-1)*E+x(),b)),b}function A(a,b){return c.bind("mouseup",y),G=!0,H=a.x,I=0,K=Date.now(),b.preventDefault(),b.stopPropagation(),!1}function B(a,b){var c,d;return G&&(c=a.x,d=H-c,(d>2||-2>d)&&(H=c,requestAnimationFrame(function(){s(z(L+d))}))),b.preventDefault(),b.stopPropagation(),!1}function C(a,b,d){c.unbind("mouseup",y),G=!1,J=L;var e=x(),f=i.carouselIndex*E,g=f-J,h=Math.abs(g)>e,j=h?0>g?1:-1:0;return J=(j+i.carouselIndex)*E,I=J-L,K=Date.now(),d&&(I=L-f),requestAnimationFrame(t),b&&(b.preventDefault(),b.stopPropagation()),!1}function D(){alert("onOrientationChange"),r(),w()}e++;var E,F,G,H,I,J,K,L=0,M=j.wrap("<div id='"+e+"' class='rn-carousel-container'></div>"),N=M.parent();if(i.carouselBufferIndex=0,i.carouselBufferSize=5,i.carouselIndex=0,k.rnCarouselIndex){var O=d(k.rnCarouselIndex);angular.isFunction(O.assign)?(i.$watch("carouselIndex",function(a){O.assign(i.$parent,a)}),i.carouselIndex=O(i),i.$parent.$watch(O,function(a){void 0!==a&&w(a,!0)}),q=!0):isNaN(k.rnCarouselIndex)||(i.carouselIndex=parseInt(k.rnCarouselIndex,10))}n?i.$watchCollection(l,function(a){p=a.length,E||r(),w(i.carouselIndex)}):r(),a.bind(M,{start:A,move:B,end:C,cancel:function(a){C({},a)}}),w(i.carouselIndex),F="transform",["webkit","Moz","O","ms"].every(function(a){var b=a+"Transform";return"undefined"!=typeof document.body.style[b]?(F=b,!1):!0});var P=angular.element(b);P.bind("orientationchange",D),i.$on("$destroy",function(){c.unbind("mouseup",y),P.unbind("orientationchange",D)})}}}}])}(),function(){"use strict";angular.module("angular-carousel").filter("carouselSlice",function(){return function(a,b,c){return a.slice(b,b+c)}})}();