/**
 * Angular Carousel - Mobile friendly touch carousel for AngularJS
 * @version v0.0.6 - 2013-05-21
 * @link http://revolunet.com.github.com/angular-carousel
 * @author Julien Bouquillon <julien@revolunet.com>
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
"use strict";angular.module("angular-carousel",["ngMobile"]).filter("carouselSlice",function(){return function(a,e,t){return a.slice(e,t)}}).directive("rnCarousel",["$document","$compile","$parse","$timeout","$swipe",function(a,e,t,n,r){var o=0;return{restrict:"A",scope:!0,compile:function(a,n){a.addClass("rn-carousel-slides");var s=a.find("li")[0].attributes["ng-repeat"],i=s.value.match(/^([^\s]+) in (.+)$/i)[2],l=angular.isDefined(n.rnCarouselBuffered);if(l){var u="|carouselSlice:carouselBufferStart:carouselBufferStart+carouselBufferSize";s.value+=u}return function(a,n,s){function u(a,e){var t={};return t[a]=e,angular.forEach(w,function(n){t["-"+n.toLowerCase()+"-"+a]=e}),t}function c(){a.activeIndex=a.totalIndex-a.carouselBufferStart}function d(){a.$watch("totalIndex",function(a,e){a!==e&&L(),c()})}o++;var f="rn-carousel-"+o,x=0,I=0,v=0,m=0,p=.1,B=0,S=!0,C=n.wrap("<div id='"+f+"' class='rn-carousel-container'></div>"),g=C.parent();a.carouselItems=[],a.carouselBufferStart=0,a.totalIndex=0,a.activeIndex=0;var h=function(a){C.addClass("rn-carousel-noanimate").css({"padding-left":a*B+"px"})},$=function(){var e=a.totalIndex>0&&0===a.totalIndex-a.carouselBufferStart,n=a.totalIndex<z()-1&&a.totalIndex-a.carouselBufferStart===C.find("li").length-1;if(e||n){var r=e?-1:1;h(a.carouselBufferStart+r),a.$apply(function(){a.carouselBufferStart+=r}),n&&s.rnCarouselOnEnd&&t(s.rnCarouselOnEnd)(a,{index:a.totalIndex+1})}},w=["webkit","moz"];if(l&&(a.carouselBufferSize=3,C[0].addEventListener("webkitTransitionEnd",$,!1),C[0].addEventListener("transitionend",$,!1),a.$watch("carouselBufferStart",function(){c()})),s.rnCarouselIndex){var b=t(s.rnCarouselIndex);angular.isFunction(b.assign)?(a.$watch("totalIndex",function(e){b.assign(a.$parent,e)}),a.$parent.$watch(b,function(e){a.totalIndex=e})):isNaN(s.rnCarouselIndex)||(a.totalIndex=parseInt(s.rnCarouselIndex,10))}d(),a.$watch(i,function(e){a.carouselItems=e;var t=C.find("li");t.length>0?(B=t[0].getBoundingClientRect().width,g.css("width",B+"px"),L()):B=0},!0);var E=angular.isDefined(s.rnCarouselIndicator);if(E){var M=e("<div id='"+f+"-indicator' index='totalIndex' items='carouselItems' data-rn-carousel-indicators class='rn-carousel-indicator'></div>")(a);g.append(M)}var z=function(){return a.carouselItems.length},L=function(){var e=S===!0;0>a.totalIndex?a.totalIndex=0:a.totalIndex>z()-1&&(a.totalIndex=z()-1),l&&((a.totalIndex<a.carouselBufferStart||a.totalIndex>a.carouselBufferStart+a.carouselBufferSize-1)&&(a.carouselBufferStart=a.totalIndex-1,e=!0,h(a.carouselBufferStart)),a.carouselBufferStart=Math.max(0,Math.min(a.carouselBufferStart,z()-a.carouselBufferSize))),m=a.totalIndex*-B,e===!0?C.addClass("rn-carousel-noanimate").css(u("transform","translate3d("+m+"px,0,0)")):C.removeClass("rn-carousel-noanimate").addClass("rn-carousel-animate").css(u("transform","translate3d("+m+"px,0,0)")),S=!1};r.bind(C,{start:function(a){0===x&&(x=1,I=a.x)},move:function(e){if(0!==x){var t=e.x-I;if(1===x&&0!==t)x=2,v=m;else if(2===x){var n=z(),r=1;(0===a.totalIndex&&e.x>I||a.totalIndex===n-1&&I>e.x)&&(r=3),m=v+t/r,C.css(u("transform","translate3d("+m+"px,0,0)")).removeClass().addClass("rn-carousel-noanimate")}}},end:function(e){var t,n=z();if(x>0){x=0,t=v>m?a.totalIndex+1:a.totalIndex-1,t=Math.min(Math.max(t,0),n-1);var r=e.x-I;B*p>=Math.abs(r)&&(t=a.totalIndex);var o=a.totalIndex!==t;a.$apply(function(){a.totalIndex=t}),o||L()}}})}}}}]).directive("rnCarouselIndicators",[function(){return{restrict:"A",replace:!0,scope:{items:"=",index:"="},template:'<div class="rn-carousel-indicator"><span ng-repeat="item in items" ng-class="{active: $index==$parent.index}">‚óè</span></div>'}}]);