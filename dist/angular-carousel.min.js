/**
 * Angular Carousel - Mobile friendly touch carousel for AngularJS
 * @version v0.0.3 - 2013-04-29
 * @link http://revolunet.com.github.com/angular-carousel
 * @author Julien Bouquillon <julien@revolunet.com>
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
"use strict";angular.module("angular-carousel",[]).directive("rnCarousel",["$document","$compile","$parse",function(e,n,r){function a(e){function n(e){var n=e.nodeValue.substring(a.length+1);return n.replace(/^\s+|\s+$/g,"")}function r(){var r=Array.prototype.slice.call(e.contents()),t=r.filter(function(e){return 8===e.nodeType&&-1!==e.nodeValue.indexOf(a)});return n(t[0])}var a="ngRepeat:",t=r(),s=/^([^\s]+) in (.+)$/i,o=t.match(s);return o[2]}var t=0;return{restrict:"A",scope:!0,compile:function(s){return s.addClass("rn-carousel-slides"),function(s,o,i){t++;var c="rn-carousel-"+t,u=0,l=0,d=0,m=0,f=.1,p=0,v=o.wrap("<div id='"+c+"' class='rn-carousel-container'></div>"),x=v.parent();if(s.carouselItems=[],s.carouselIndex=0,i.rnCarouselIndex){var h=r(i.rnCarouselIndex);s.$watch("carouselIndex",function(e){h.assign(s.$parent,e)}),s.$parent.$watch(r(i.rnCarouselIndex),function(e){s.carouselIndex=e,w()})}else s.$watch("carouselIndex",function(){w()});var I=a(o);s.$watch(I,function(e){s.carouselItems=e;var n=v.find("li");n.length>0?(p=n[0].getBoundingClientRect().width,x.css("width",p+"px"),w()):p=0},!0);var g="true"===i.rnCarouselIndicator;if(g){var $=n("<div id='"+c+"-indicator' index='carouselIndex' items='carouselItems' data-rn-carousel-indicators class='rn-carousel-indicator'></div>")(s);x.append($)}var C=function(){return s.carouselItems.length},w=function(){m=s.carouselIndex*-p,v.removeClass("rn-carousel-noanimate").addClass("rn-carousel-animate").css({"-webkit-transform":"translate3d("+m+"px,0,0)","-moz-transform":"translate3d("+m+"px,0,0)","-ms-transform":"translate3d("+m+"px,0,0)","-o-transform":"translate3d("+m+"px,0,0)",transform:"translate3d("+m+"px,0,0)"})},b=function(e){return e.originalEvent!==void 0&&e.originalEvent.touches>0?e=e.originalEvent.touches[0]:e.touches!==void 0&&e.touches.length>0?e=e.touches[0]:e.changedTouches!==void 0&&e.changedTouches.length>0&&(e=e.changedTouches[0]),e},X=function(n){n=b(n),0===u&&(u=1,l=n.clientX),e.bind("mouseup",T)},y=function(e){if(0!==u){e.preventDefault(),e=b(e);var n=e.clientX-l;if(1===u&&0!==n)u=2,d=m;else if(2===u){var r=C(),a=1;(0===s.carouselIndex&&e.clientX>l||s.carouselIndex===r-1&&l>e.clientX)&&(a=3),m=d+n/a,v.css({"-webkit-transform":"translate3d("+m+"px,0,0)","-moz-transform":"translate3d("+m+"px,0,0)","-ms-transform":"translate3d("+m+"px,0,0)","-o-transform":"translate3d("+m+"px,0,0)",transform:"translate3d("+m+"px,0,0)"}).removeClass().addClass("rn-carousel-noanimate")}}},T=function(n){e.unbind("mouseup",T),n=b(n);var r,a=C();if(u>0){u=0,r=d>m?s.carouselIndex+1:s.carouselIndex-1,r=Math.min(Math.max(r,0),a-1);var t=n.clientX-l;p*f>=Math.abs(t)&&(r=s.carouselIndex);var o=s.carouselIndex!==r;s.$apply(function(){s.carouselIndex=r}),o||w()}};x.bind("mousedown touchstart",X),x.bind("mousemove touchmove",y),x.bind("mouseup touchend",T)}}}}]).directive("rnCarouselIndicators",[function(){return{restrict:"A",replace:!0,scope:{items:"=",index:"="},template:'<div class="rn-carousel-indicator"><span ng-repeat="item in items" ng-class="{active: $index==$parent.index}">‚óè</span></div>'}}]);