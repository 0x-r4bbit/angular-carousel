/**
 * Angular Carousel - Mobile friendly touch carousel for AngularJS
 * @version v0.0.1 - 2013-04-24
 * @link http://revolunet.com.github.com/angular-carousel
 * @author Julien Bouquillon <julien@revolunet.com>
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
"use strict";angular.module("angular-carousel",[]).directive("carousel",["$document",function(){var e=0;return{restrict:"A",scope:!0,controller:["$scope","$element","$attrs",function(e,n){var t=0,i=0;this.addElement=function(e){t++,1===t&&(i=e[0].getBoundingClientRect().width,n.parent().css("width",this.getWidth()-2+"px"))},this.removeElement=function(){t--},this.getWidth=function(){return i}}],compile:function(n){return n.addClass("carousel-slides"),n.find("li").attr("slide-announcer",!0),function(n,t,i,o){e++;var r="carousel-"+e,a=0,u=0,c=0,s=0,l=0,d=.1,h=t.wrap("<div id='"+r+"' class='carousel-container'></div>"),m=h.parent();m.getWidth=o.getWidth;var f=function(){return h.find("li")},v=function(){return f().length},g=function(e){return e.originalEvent!==void 0&&e.originalEvent.touches>0?e=e.originalEvent.touches[0]:e.touches!==void 0&&e.touches.length>0?e=e.touches[0]:e.changedTouches!==void 0&&e.changedTouches.length>0&&(e=e.changedTouches[0]),e},p=function(e){e=g(e),0===a&&(a=1,u=e.clientX),angular.element(document.body).bind("mouseup",E)},b=function(e){if(0!==a){e.preventDefault(),e=g(e);var n=e.clientX-u;if(1===a&&0!==n)a=2,c=s;else if(2===a){var t=v(),i=1;(0===l&&e.clientX>u||l===t-1&&u>e.clientX)&&(i=3),s=c+n/i,h.css({"-webkit-transform":"translate3d("+s+"px,0,0)"}).removeClass().addClass("carousel-noanimate")}}},E=function(e){angular.element(document.body).unbind("mouseup",E),e=g(e);var n=v(),t=l;if(a>0){a=0,l=c>s?l+1:l-1,l=Math.min(Math.max(l,0),n-1);var i=m.getWidth(),o=e.clientX-u;i*d>=Math.abs(o)&&(l=t),s=l*-i,h.removeClass("carousel-noanimate").addClass("carousel-animate").css("-webkit-transform","translate3d("+s+"px,0,0)")}};m.bind("mousedown touchstart",p),m.bind("mousemove touchmove",b),m.bind("mouseup touchend",E),n.destroy=function(){}}}}}]).directive("slideAnnouncer",function(){return{restrict:"A",require:"^carousel",link:function(e,n,t,i){i&&(i.addElement(n),e.$on("$destroy",function(){i.removeElement(n)}))}}});