/**
 * Angular Carousel - Mobile friendly touch carousel for AngularJS
 * @version v0.0.4 - 2013-05-08
 * @link http://revolunet.com.github.com/angular-carousel
 * @author Julien Bouquillon <julien@revolunet.com>
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
"use strict";angular.module("angular-carousel",[]).directive("rnCarousel",["$document","$compile","$parse",function(e,n,a){var r=0;return{restrict:"A",scope:!0,compile:function(t){t.addClass("rn-carousel-slides");var s=t.find("li")[0].attributes["ng-repeat"].nodeValue,o=s.match(/^([^\s]+) in (.+)$/i)[2];return function(t,s,i){r++;var c="rn-carousel-"+r,u=0,l=0,d=0,m=0,p=.1,f=0,v=s.wrap("<div id='"+c+"' class='rn-carousel-container'></div>"),x=v.parent();if(t.carouselItems=[],t.carouselIndex=0,i.rnCarouselIndex){var h=a(i.rnCarouselIndex);t.$watch("carouselIndex",function(e){h.assign(t.$parent,e)}),t.$parent.$watch(a(i.rnCarouselIndex),function(e){t.carouselIndex=e,C()})}else t.$watch("carouselIndex",function(){C()});t.$watch(o,function(e){t.carouselItems=e;var n=v.find("li");n.length>0?(f=n[0].getBoundingClientRect().width,x.css("width",f+"px"),C()):f=0},!0);var I="true"===i.rnCarouselIndicator;if(I){var g=n("<div id='"+c+"-indicator' index='carouselIndex' items='carouselItems' data-rn-carousel-indicators class='rn-carousel-indicator'></div>")(t);x.append(g)}var $=function(){return t.carouselItems.length},C=function(){m=t.carouselIndex*-f,v.removeClass("rn-carousel-noanimate").addClass("rn-carousel-animate").css({"-webkit-transform":"translate3d("+m+"px,0,0)","-moz-transform":"translate3d("+m+"px,0,0)","-ms-transform":"translate3d("+m+"px,0,0)","-o-transform":"translate3d("+m+"px,0,0)",transform:"translate3d("+m+"px,0,0)"})},w=function(e){return e.originalEvent!==void 0&&e.originalEvent.touches>0?e=e.originalEvent.touches[0]:e.touches!==void 0&&e.touches.length>0?e=e.touches[0]:e.changedTouches!==void 0&&e.changedTouches.length>0&&(e=e.changedTouches[0]),e},b=function(n){n=w(n),0===u&&(u=1,l=n.clientX),e.bind("mouseup",E)},X=function(e){if(0!==u){e.preventDefault(),e=w(e);var n=e.clientX-l;if(1===u&&0!==n)u=2,d=m;else if(2===u){var a=$(),r=1;(0===t.carouselIndex&&e.clientX>l||t.carouselIndex===a-1&&l>e.clientX)&&(r=3),m=d+n/r,v.css({"-webkit-transform":"translate3d("+m+"px,0,0)","-moz-transform":"translate3d("+m+"px,0,0)","-ms-transform":"translate3d("+m+"px,0,0)","-o-transform":"translate3d("+m+"px,0,0)",transform:"translate3d("+m+"px,0,0)"}).removeClass().addClass("rn-carousel-noanimate")}}},E=function(n){e.unbind("mouseup",E),n=w(n);var a,r=$();if(u>0){u=0,a=d>m?t.carouselIndex+1:t.carouselIndex-1,a=Math.min(Math.max(a,0),r-1);var s=n.clientX-l;f*p>=Math.abs(s)&&(a=t.carouselIndex);var o=t.carouselIndex!==a;t.$apply(function(){t.carouselIndex=a}),o||C()}};x.bind("mousedown touchstart",b),x.bind("mousemove touchmove",X),x.bind("mouseup touchend",E)}}}}]).directive("rnCarouselIndicators",[function(){return{restrict:"A",replace:!0,scope:{items:"=",index:"="},template:'<div class="rn-carousel-indicator"><span ng-repeat="item in items" ng-class="{active: $index==$parent.index}">‚óè</span></div>'}}]);