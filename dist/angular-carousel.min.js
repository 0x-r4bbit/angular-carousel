/**
 * Angular Carousel - Mobile friendly touch carousel for AngularJS
 * @version v0.0.1 - 2013-04-24
 * @link http://revolunet.com.github.com/angular-carousel
 * @author Julien Bouquillon <julien@revolunet.com>
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
"use strict";angular.module("angular-carousel",[]).directive("carousel",["$document",function(){var e=0;return{restrict:"A",scope:!0,controller:["$scope","$element","$attrs",function(e,t){var n=0,i=0;this.addElement=function(e){n++,1===n&&(i=e[0].getBoundingClientRect().width,t.parent().css("width",this.getWidth()-2+"px"))},this.removeElement=function(){n--},this.getWidth=function(){return i}}],compile:function(t){return t.addClass("carousel-slides"),t.find("li").attr("slide-announcer",!0),function(t,n,i,o){e++;var r="carousel-"+e,a=0,c=0,s=0,u=0,l=0,d=.1,h=n.wrap("<div id='"+r+"' class='carousel-container'></div>"),f=h.parent();f.getWidth=o.getWidth;var m=function(){return h.find("li")},v=function(){return m().length},g=function(e){return e.originalEvent!==void 0&&e.originalEvent.touches>0?e=e.originalEvent.touches[0]:e.touches!==void 0&&e.touches.length>0?e=e.touches[0]:e.changedTouches!==void 0&&e.changedTouches.length>0&&(e=e.changedTouches[0]),e},p=function(e){e=g(e),0===a&&(a=1,c=e.clientX)},E=function(e){if(0!==a){e.preventDefault(),e=g(e);var t=e.clientX-c;if(1===a&&0!==t)a=2,s=u;else if(2===a){var n=v(),i=1;(0===l&&e.clientX>c||l===n-1&&c>e.clientX)&&(i=3),u=s+t/i,h.css({"-webkit-transform":"translate3d("+u+"px,0,0)"}).removeClass().addClass("carousel-noanimate")}}},b=function(e){e=g(e);var t=v(),n=l;if(a>0){a=0,l=s>u?l+1:l-1,l=Math.min(Math.max(l,0),t-1);var i=f.getWidth(),o=e.clientX-c;i*d>=Math.abs(o)&&(l=n),u=l*-i,h.removeClass("carousel-noanimate").addClass("carousel-animate").css("-webkit-transform","translate3d("+u+"px,0,0)")}},w=function(e){console.log("mouseExit",e,e.targetElement)};f.bind("mousedown touchstart",p),f.bind("mousemove touchmove",E),f.bind("mouseup touchend",b),h.bind("mouseleave",w,!0),t.destroy=function(){}}}}}]).directive("slideAnnouncer",function(){return{restrict:"A",require:"^carousel",link:function(e,t,n,i){i&&(i.addElement(t),e.$on("$destroy",function(){i.removeElement(t)}))}}});